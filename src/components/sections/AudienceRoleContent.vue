<template>
  <div>
    <h3>è§‚ä¼—ï¼šæµé‡çš„æ¨æ‰‹</h3>
    <!-- è§‚ä¼—ç”»åƒåˆ†æ -->
    <h4 class="section-subtitle">è°åœ¨è§‚çœ‹èŒå¨ƒè§†é¢‘ï¼Ÿ</h4>

    <!-- <div class="audience-summary">
      <p>è§‚çœ‹èŒå¨ƒç±»çŸ­è§†é¢‘çš„è§‚ä¼—ç”»åƒç‰¹å¾ï¼š</p>
      <ul>
        <li><strong>å¹´é¾„ï¼š</strong>31-40å²å æ¯”æœ€é«˜ï¼Œ18-23å²åå¥½åº¦æœ€é«˜</li>
        <li><strong>æ€§åˆ«ï¼š</strong>å¥³æ€§å æ¯”68%ï¼Œåå¥½åº¦ï¼ˆTGIï¼‰è¾¾128</li>
        <li><strong>åœ°åŸŸï¼š</strong>å¹¿ä¸œå æ¯”æœ€é«˜ï¼Œè¾½å®åå¥½åº¦ï¼ˆTGIæŒ‡æ•°ï¼‰æœ€é«˜</li>
      </ul>
    </div>
    <p class="data-source">
      æ•°æ®æ¥æºï¼šQuestMobileã€Š2024çŸ­è§†é¢‘ç”¨æˆ·ç ”ç©¶æŠ¥å‘Šã€‹ã€å·¨é‡ç®—æ•°ã€ŠèŒå¨ƒå†…å®¹è§‚ä¼—æ´å¯ŸæŠ¥å‘Šã€‹
    </p> -->
    <div class="audience-charts">
      <!-- å¹´é¾„åˆ†å¸ƒå›¾ -->
      <div class="chart-card">
        <div class="chart-header">
          <h5>å¹´é¾„åˆ†å¸ƒ</h5>
        </div>
        <div class="chart-summary">
          <span class="highlight-text">31-40å²</span>å¹´é¾„æ®µå æ¯”æœ€é«˜ï¼Œ
          <span class="highlight-text">18-23å²</span>å¹´é¾„æ®µåå¥½åº¦ï¼ˆTGIæŒ‡æ•°ï¼‰æœ€é«˜
        </div>
        <div class="chart-legend">
          <span class="legend-item">
            <span class="legend-color" style="background: #5B8FF9"></span>
            å æ¯”
          </span>
          <span class="legend-item">
            <span class="legend-color" style="background: #5AD8A6"></span>
            TGI
          </span>
        </div>
        <div class="chart-container" ref="chartAudienceAge"></div>
      </div>

      <!-- æ€§åˆ«åˆ†å¸ƒå›¾ -->
      <div class="chart-card">
        <div class="chart-header">
          <h5>æ€§åˆ«åˆ†å¸ƒ</h5>
        </div>
        <div class="chart-summary">
          <span class="highlight-text">å¥³æ€§</span>å æ¯”68%ï¼Œåå¥½åº¦è¾¾128
        </div>
        <div class="gender-chart-container">
          <img :src="genderChartImg" alt="æ€§åˆ«åˆ†å¸ƒæ³¨æ°´å›¾" class="gender-chart-image" />
          <div class="gender-stats">
            <div class="gender-stat-item">
              <div class="gender-label" style="color: #FF6B9D;">å¥³æ€§</div>
              <div class="stat-text">
                <span>å æ¯”: <strong>68%</strong></span>
              </div>
              <div class="stat-text">
                <span>TGI: <strong>128</strong></span>
              </div>
            </div>
            <div class="gender-stat-item">
              <div class="gender-label" style="color: #5B8FF9;">ç”·æ€§</div>
              <div class="stat-text">
                <span>å æ¯”: <strong>32%</strong></span>
              </div>
              <div class="stat-text">
                <span>TGI: <strong>68</strong></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- åœ°åŸŸåˆ†å¸ƒ -->
    <h4 class="section-subtitle">åœ°åŸŸåˆ†å¸ƒ</h4>
    <p class="data-note">
      è§‚çœ‹èŒå¨ƒç±»çŸ­è§†é¢‘çš„è§‚ä¼—ä¸­ï¼Œ<span style="color:red">å¹¿ä¸œ</span>å æ¯”æœ€é«˜ï¼Œ<span style="color:red">è¾½å®</span>åå¥½åº¦ï¼ˆTGIæŒ‡æ•°ï¼‰æœ€é«˜
    </p>
    <div class="chart-container map-chart" ref="chartAudienceRegion"></div>

    <!-- è§‚ä¼—å¿ƒç†åˆ†æ -->
    <div class="audience-psychology">
      <div class="psychology-positive">
        <p>è§‚çœ‹è€…ä¸­ä¸ä¹çœŸæ­£å–œçˆ±å­©å­ã€é€šè¿‡è§†é¢‘è·å¾—æƒ…æ„Ÿæ…°è—‰çš„ç”¨æˆ·ã€‚</p>
        <p>
          ä»è¿›åŒ–å¿ƒç†å­¦è§’åº¦è§£é‡Šï¼Œè¿™ç§ç°è±¡æ˜¯å› ä¸ºäººç±»å¤©ç”Ÿä¼šå¯¹å…·æœ‰"å©´å„¿å›¾å¼"ï¼ˆå¦‚åœ†è„¸ã€å¤§çœ¼ç­‰ç‰¹å¾ï¼‰çš„å¹¼å´½äº§ç”Ÿä¿æŠ¤æ¬²å’Œäº²å¯†æ„Ÿï¼Œè¿™æ˜¯ä¸€ç§æœ¬èƒ½ååº”ï¼Œè€Œå¥³æ€§é€šå¸¸å¯¹æ­¤æ›´ä¸ºæ•æ„Ÿã€‚èŒå¨ƒä»¬å¤©çœŸæ— é‚ªçš„è¨€è¡Œå’Œæ¸©é¦¨çš„å®¶åº­äº’åŠ¨åœºæ™¯ï¼Œä¸ºå¹´è½»è§‚ä¼—æä¾›äº†ä¸€ä¸ªé€ƒç¦»ç°å®å‹åŠ›ã€è·å¾—æƒ…ç»ªç–—æ„ˆçš„çª—å£ã€‚è§‚çœ‹è¿™äº›å†…å®¹èƒ½æœ‰æ•ˆç¼“è§£ç„¦è™‘ï¼Œå¸¦æ¥è½»æ¾å’Œå¿«ä¹ã€‚
        </p>
      </div>

      <div class="psychology-negative">
        <h4 class="section-subtitle">è¯„è®ºåŒºçš„å£°éŸ³</h4>
        <p>
          <strong>"å•ƒå¨ƒé€»è¾‘"</strong>æ­£åœ¨é€æ¸è¢«æ›´å¤šäººæ¥å—ã€‚ç”šè‡³å‡ºç°äº†ä¸€æ‰¹"æ¯å©´åšä¸»é™ªè·‘""å®å¦ˆä¸“ä¸šè¿è¥"ç­‰ä¸“é—¨æ•™å¯¼å®¶é•¿å¦‚ä½•æ‰“é€ "å°ç½‘çº¢"çš„è´¦å·ã€‚ç›¸å…³è§†é¢‘è¯„è®ºåŒºé‡Œï¼Œå¯¹å¹¼ç«¥æ“¦è¾¹å†…å®¹çš„è¿½æ§ã€å¯¹å„¿ç«¥"å°å°å¹´çºªæŒ£å¤§é’±"çš„ç¾¡æ…•ã€‚
        </p>
        <div class="chart-container wordcloud-chart" ref="chartWordCloud"></div>
      </div>
    </div>

    <!-- æµé‡ç‹‚æ½®æ¡ˆä¾‹ -->
    <div class="traffic-craze">
      <p class="craze-intro">
        èŒå¨ƒçš„å¤©ç„¶æµé‡ä¼˜åŠ¿å†åŠ ä¹‹ç²‰ä¸è¿½æ§ï¼Œ"æ™’å¨ƒ"è¡Œä¸ºåœ¨ç›¸å…³å¹³å°è¶Šçƒ§è¶Šæ—ºã€‚
      </p>
      <div class="craze-case">
        <div class="case-image-wrapper">
          <img :src="trafficCaseImg" alt="æ–°ç”Ÿå„¿ç½‘çº¢æ¡ˆä¾‹" class="case-image" />
        </div>
        <p class="case-caption">
          æŸåƒä¸‡çº§ç½‘çº¢çˆ¶æ¯ä¸ºå…¶æ–°ç”Ÿå„¿"å…‰é€Ÿ"æ³¨å†Œè´¦å·ã€‚ä»…1æ¡è§†é¢‘ï¼ŒæŠ–éŸ³å¸ç²‰åå‡ ä¸‡ï¼Œç‚¹èµè¶…30ä¸‡ã€‚
        </p>
      </div>
    </div>

    <!-- è§‚ä¼—è´£ä»»æç¤º -->
    <div class="responsibility-box">
      <p>è§‚ä¼—çš„æ¯ä¸€æ¬¡ç‚¹å‡»ã€æ¯ä¸€ä¸ªèµï¼Œéƒ½åœ¨æ— å½¢ä¸­é¼“åŠ±ç€æ›´å¤šçˆ¶æ¯å°†å­©å­æ¨å‘é•œå¤´ã€‚è€Œå¹³å°çš„ç®—æ³•ä¼šè¿›ä¸€æ­¥æ”¾å¤§è¿™ç§æ•ˆåº”ï¼Œè®©"èŒå¨ƒ"å†…å®¹è·å¾—æ›´å¤šæ›å…‰ï¼Œå½¢æˆæ­£åé¦ˆå¾ªç¯ã€‚</p>
      <p>ä½œä¸ºè§‚ä¼—ï¼Œæˆ‘ä»¬éœ€è¦æ„è¯†åˆ°ï¼šæˆ‘ä»¬çš„å…³æ³¨å’Œäº’åŠ¨ï¼Œå¯èƒ½åœ¨æ— æ„ä¸­æˆä¸ºäº†å„¿ç«¥è¢«è¿‡åº¦æ›å…‰çš„æ¨æ‰‹ã€‚<strong>ç†æ€§æ¶ˆè´¹å†…å®¹ï¼Œæ‹’ç»çŒå¥‡å’Œæ¶ˆè´¹å„¿ç«¥éšç§çš„è§†é¢‘ï¼Œæ˜¯æ¯ä¸ªè§‚ä¼—åº”æœ‰çš„è´£ä»»ã€‚</strong>
      </p>
    </div>


  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from 'vue'
import * as echarts from 'echarts'

const chartAudienceAge = ref(null)
const chartAudienceRegion = ref(null)
const chartWordCloud = ref(null)

// æµé‡æ¡ˆä¾‹å›¾ç‰‡
const trafficCaseImg = new URL('@/assets/images/10.png', import.meta.url).href
// æ€§åˆ«åˆ†å¸ƒæ³¨æ°´å›¾
const genderChartImg = new URL('@/assets/images/æ³¨æ°´å›¾.png', import.meta.url).href

let cloudObserver = null

onMounted(() => {
  // å¹´é¾„åˆ†å¸ƒï¼ˆåŒè½´æŸ±çŠ¶å›¾ï¼‰
  if (chartAudienceAge.value) {
    const myChartAge = echarts.init(chartAudienceAge.value)
    myChartAge.setOption({
      grid: { left: '12%', right: '12%', top: '15%', bottom: '15%' },
      tooltip: {
        trigger: 'axis',
        axisPointer: { type: 'shadow' }
      },
      xAxis: {
        type: 'category',
        data: ['18-23å²', '24-30å²', '31-40å²', '41-50å²', '51å²+'],
        axisLine: { lineStyle: { color: '#E5E5E5' } },
        axisTick: { show: false },
        axisLabel: { color: '#666' }
      },
      yAxis: [
        {
          type: 'value',
          name: 'å æ¯”',
          position: 'left',
          axisLabel: { formatter: '{value}%', color: '#666' },
          axisLine: { show: false },
          splitLine: { lineStyle: { color: '#F0F0F0', type: 'dashed' } },
          max: 32
        },
        {
          type: 'value',
          name: 'TGI',
          position: 'right',
          axisLabel: { color: '#666' },
          axisLine: { show: false },
          splitLine: { show: false },
          max: 280
        }
      ],
      series: [
        {
          name: 'å æ¯”',
          type: 'bar',
          data: [24, 24, 30, 12, 10],
          barWidth: '35%',
          itemStyle: {
            color: '#5B8FF9',
            borderRadius: [4, 4, 0, 0]
          }
        },
        {
          name: 'TGI',
          type: 'line',
          yAxisIndex: 1,
          data: [250, 180, 95, 60, 100],
          smooth: true,
          symbol: 'circle',
          symbolSize: 8,
          itemStyle: {
            color: '#5AD8A6',
            borderWidth: 2,
            borderColor: '#fff'
          },
          lineStyle: {
            color: '#5AD8A6',
            width: 3
          },
          markLine: {
            silent: true,
            symbol: 'none',
            lineStyle: {
              color: '#FFBB00',
              type: 'dashed',
              width: 2
            },
            data: [{ yAxis: 100 }],
            label: { show: false }
          }
        }
      ]
    })
  }

  // åœ°åŸŸåˆ†å¸ƒï¼ˆäº¤äº’åœ°å›¾ï¼‰
  if (chartAudienceRegion.value) {
    const el = chartAudienceRegion.value
    const myChartRegion = echarts.init(el)
    const regionData = [
      { name: 'å¹¿ä¸œ', value: 15.2 },
      { name: 'è¾½å®', value: 12.8 },
      { name: 'æ±Ÿè‹', value: 10.5 },
      { name: 'æµ™æ±Ÿ', value: 9.8 },
      { name: 'å±±ä¸œ', value: 8.6 },
      { name: 'æ²³å—', value: 7.3 },
      { name: 'å››å·', value: 6.9 },
      { name: 'æ¹–åŒ—', value: 6.2 },
      { name: 'åŒ—äº¬', value: 5.8 },
      { name: 'ä¸Šæµ·', value: 5.1 }
    ]
      ; (async () => {
        try {
          const mapUrl = `${import.meta.env.BASE_URL}china.json`
          const res = await fetch(mapUrl)
          if (!res.ok) throw new Error('map not found')
          const mapJson = await res.json()
          echarts.registerMap('china', mapJson)

          const values = regionData.map(d => d.value)
          const minVal = Math.min(...values)
          const maxVal = Math.max(...values)

          myChartRegion.setOption({
            tooltip: {
              trigger: 'item',
              formatter: (p) => (p?.value
                ? `<strong>${p.name}</strong><br/>å æ¯”ï¼š<span style="color:#667eea;font-weight:bold;">${p.value}%</span>`
                : `${p.name}<br/>æš‚æ— æ•°æ®`),
              backgroundColor: 'rgba(255,255,255,0.95)',
              borderColor: '#ddd',
              borderWidth: 1,
              textStyle: { color: '#333' }
            },
            visualMap: {
              min: Math.floor(minVal),
              max: Math.ceil(maxVal),
              left: 30,
              bottom: 40,
              text: ['é«˜', 'ä½'],
              inRange: { color: ['#fee5d9', '#fcae91', '#fb6a4a', '#de2d26', '#a50f15'] },
              textStyle: { color: '#666' },
              calculable: true
            },
            series: [{
              type: 'map',
              map: 'china',
              roam: true,
              scaleLimit: { min: 1, max: 3 },
              emphasis: {
                label: { show: true, color: '#fff' },
                itemStyle: { areaColor: '#667eea', shadowBlur: 10, shadowColor: 'rgba(0,0,0,0.3)' }
              },
              select: { label: { show: true }, itemStyle: { areaColor: '#764ba2' } },
              itemStyle: { borderColor: '#fff', borderWidth: 1, shadowBlur: 5, shadowColor: 'rgba(0,0,0,0.1)' },
              data: regionData
            }]
          })
        } catch (e) {
          console.warn('China map load failed:', e)
        }
      })()
  }

  // è¯„è®ºè¯äº‘ï¼ˆæ‡’åŠ è½½ï¼‰
  if (chartWordCloud.value) {
    const el = chartWordCloud.value
    let inited = false
    const words = [
      { name: 'å¯çˆ±', value: 1000 }, { name: 'å®å®', value: 950 }, { name: 'æ¼‚äº®', value: 900 },
      { name: 'å¤©ä½¿', value: 850 }, { name: 'èŒ', value: 800 }, { name: 'å–œæ¬¢', value: 750 },
      { name: 'å¦¹å¦¹', value: 700 }, { name: 'å¥³å„¿', value: 680 }, { name: 'å°å­©', value: 650 },
      { name: 'æ²»æ„ˆ', value: 620 }, { name: 'ç«¥å¹´', value: 600 }, { name: 'å¹¸ç¦', value: 580 },
      { name: 'æ¸©æŸ”', value: 560 }, { name: 'å¤©çœŸ', value: 540 }, { name: 'å¿«ä¹', value: 520 },
      { name: 'å¦ˆå¦ˆ', value: 500 }, { name: 'ç²¾è‡´', value: 480 }, { name: 'å°è£™å­', value: 460 },
      { name: 'å¥½çœ‹', value: 440 }, { name: 'æŠ±æŠ±', value: 420 }, { name: 'æ‰“æ‰®', value: 400 },
      { name: 'èˆè¹ˆ', value: 380 }, { name: 'å®¶é•¿', value: 360 }, { name: 'æ‘†æ‹', value: 340 },
      { name: 'ç‚«å¨ƒ', value: 320 }, { name: 'æ¼”æˆ', value: 300 }, { name: 'è™šä¼ª', value: 280 },
      { name: 'åˆ©ç”¨å­©å­', value: 260 }, { name: 'åˆ»æ„', value: 240 }, { name: 'ç¦»è°±', value: 220 },
      { name: 'åƒµç¡¬', value: 200 }
    ]

    // åˆ›å»ºæ‰‹æœºå½¢çŠ¶çš„é®ç½©å›¾ç‰‡
    const createPhoneMask = () => {
      const canvas = document.createElement('canvas')
      const size = 600
      canvas.width = size
      canvas.height = size
      const ctx = canvas.getContext('2d')

      // ç»˜åˆ¶æ‰‹æœºå¤–å½¢
      ctx.fillStyle = '#000'
      ctx.beginPath()

      // æ‰‹æœºä¸»ä½“ - åœ†è§’çŸ©å½¢
      const phoneWidth = 300
      const phoneHeight = 520
      const offsetX = (size - phoneWidth) / 2
      const offsetY = (size - phoneHeight) / 2
      const radius = 40

      ctx.moveTo(offsetX + radius, offsetY)
      ctx.lineTo(offsetX + phoneWidth - radius, offsetY)
      ctx.arcTo(offsetX + phoneWidth, offsetY, offsetX + phoneWidth, offsetY + radius, radius)
      ctx.lineTo(offsetX + phoneWidth, offsetY + phoneHeight - radius)
      ctx.arcTo(offsetX + phoneWidth, offsetY + phoneHeight, offsetX + phoneWidth - radius, offsetY + phoneHeight, radius)
      ctx.lineTo(offsetX + radius, offsetY + phoneHeight)
      ctx.arcTo(offsetX, offsetY + phoneHeight, offsetX, offsetY + phoneHeight - radius, radius)
      ctx.lineTo(offsetX, offsetY + radius)
      ctx.arcTo(offsetX, offsetY, offsetX + radius, offsetY, radius)
      ctx.closePath()
      ctx.fill()

      // ç»˜åˆ¶é¡¶éƒ¨åˆ˜æµ·ï¼ˆå¯é€‰ï¼‰
      ctx.fillRect(offsetX + phoneWidth / 2 - 60, offsetY + 10, 120, 25)

      return canvas
    }

    cloudObserver = new IntersectionObserver((entries) => {
      entries.forEach(async (entry) => {
        if (entry.isIntersecting && !inited) {
          inited = true
          let loaded = true
          try { await import('echarts-wordcloud') } catch (_) { loaded = false }
          if (!loaded) { cloudObserver?.unobserve(el); return }

          const maskImage = createPhoneMask()
          const inst = echarts.init(el)

          inst.setOption({
            tooltip: { show: true, formatter: (p) => `${p.name}<br/>çƒ­åº¦: ${p.value}` },
            series: [{
              type: 'wordCloud',
              gridSize: 8,
              sizeRange: [14, 55],
              rotationRange: [-20, 20],
              maskImage: maskImage,
              width: '100%',
              height: '100%',
              drawOutOfBound: false,
              layoutAnimation: true,
              textStyle: {
                fontFamily: 'sans-serif',
                fontWeight: 'bold',
                color: (params) => {
                  const negative = ['æ‘†æ‹', 'ç‚«å¨ƒ', 'æ¼”æˆ', 'è™šä¼ª', 'åˆ©ç”¨å­©å­', 'åˆ»æ„', 'ç¦»è°±', 'åƒµç¡¬', 'å®¶é•¿']
                  if (negative.includes(params.name)) {
                    const dark = ['#e74c3c', '#c0392b', '#d35400', '#e67e22']
                    return dark[Math.floor(Math.random() * dark.length)]
                  }
                  const colors = ['#5470c6', '#91cc75', '#fac858', '#73c0de', '#3ba272', '#fc8452', '#9a60b4', '#ea7ccc']
                  return colors[Math.floor(Math.random() * colors.length)]
                }
              },
              emphasis: {
                focus: 'self',
                textStyle: {
                  shadowBlur: 15,
                  shadowColor: 'rgba(0,0,0,0.4)',
                  fontSize: 18
                }
              },
              data: words
            }]
          })
          cloudObserver?.unobserve(el)
        }
      })
    }, { threshold: 0.25 })
    cloudObserver.observe(el)
  }
})

onUnmounted(() => {
  cloudObserver?.disconnect?.()
    ;[chartAudienceAge, chartAudienceRegion, chartWordCloud].forEach(r => {
      if (r?.value) {
        const inst = echarts.getInstanceByDom(r.value)
        inst && inst.dispose()
      }
    })
})
</script>

<style scoped>
/* ==================== å…¨å±€æ®µè½æ ·å¼ ==================== */
p {
  word-spacing: 0;
  text-rendering: optimizeLegibility;
  word-break: normal;
}

/* ==================== æ–‡æœ¬æ ·å¼ ==================== */
h3 {
  font-size: var(--font-size-h2, 2.2rem);
  font-weight: 700;
  color: #2c3e50;
  margin: 0 0 var(--spacing-xl, 40px) 0;
  padding-bottom: var(--spacing-lg, 25px);
  letter-spacing: -0.02em;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  position: relative;
  max-width: 1400px;
  margin-left: auto;
  margin-right: auto;
}

h3::after {
  /* content: ''; */
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100px;
  height: 4px;
  background: linear-gradient(90deg, #667eea, #ff6b6b, #51cf66, #667eea);
  background-size: 200% 100%;
  border-radius: 2px;
  animation: gradientShift 3s ease infinite;
}

.intro-text {
  font-size: 1.15rem;
  line-height: 1.5;
  color: #555;
  margin: 0 auto var(--spacing-lg, 25px);
  max-width: 1400px;
  padding: var(--spacing-md, 18px) var(--spacing-lg, 25px);
  text-align: justify;
  text-justify: inter-ideograph;
  overflow-wrap: break-word;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  border-radius: var(--radius-md, 16px);
  border-left: 4px solid #667eea;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
  backdrop-filter: blur(10px);
}

@keyframes gradientShift {

  0%,
  100% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }
}

/* ==================== æ•°æ®é«˜äº®æ ·å¼ ==================== */
.data-highlight {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 22px 28px;
  border-radius: 18px;
  color: white;
  margin: 20px 0 30px;
  box-shadow: 0 10px 30px rgba(102, 126, 234, 0.35);
}

.data-highlight p {
  margin: 8px 0;
  font-size: 1.1rem;
  line-height: 1.5;
  overflow-wrap: break-word;
}

.data-highlight .big {
  font-size: 1.9rem;
  font-weight: 800;
  color: #ffd700;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4);
  padding: 0 5px;
}

/* ==================== å°æ ‡é¢˜æ ·å¼ ==================== */
.section-subtitle {
  font-size: var(--font-size-h3, 1.8rem);
  font-weight: 700;
  color: #2c3e50;
  margin: var(--spacing-xl, 40px) auto var(--spacing-lg, 25px);
  padding-bottom: var(--spacing-md, 20px);
  position: relative;
  max-width: 1400px;
  margin-left: auto;
  margin-right: auto;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.section-subtitle::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 80px;
  height: 4px;
  background: linear-gradient(90deg, #667eea, #764ba2);
  border-radius: 2px;
}

/* ==================== è§‚ä¼—æ€»ç»“æ¡† ==================== */
.audience-summary {
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  padding: var(--spacing-md, 18px) var(--spacing-lg, 25px);
  border-radius: var(--radius-md, 16px);
  margin: var(--spacing-md, 20px) auto var(--spacing-lg, 25px);
  max-width: 1400px;
  border-left: 4px solid #667eea;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
  backdrop-filter: blur(10px);
}

.audience-summary p {
  font-size: 1.05rem;
  font-weight: 600;
  color: #2c3e50;
  margin: 0 0 10px 0;
}

.audience-summary ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.audience-summary li {
  font-size: 1.05rem;
  color: #555;
  line-height: 1.5;
  padding-left: 25px;
  position: relative;
  text-align: justify;
  text-justify: inter-ideograph;
  overflow-wrap: break-word;
}

.audience-summary li::before {
  content: 'â–¸';
  position: absolute;
  left: 0;
  color: #667eea;
  font-size: 1.2rem;
  font-weight: bold;
}

.audience-summary li strong {
  color: #667eea;
  font-weight: 700;
}

/* ==================== å›¾è¡¨å®¹å™¨æ ·å¼ ==================== */
.audience-charts {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
  gap: var(--spacing-lg, 24px);
  margin: var(--spacing-xl, 40px) auto;
  max-width: 1400px;
  padding: 0 var(--spacing-md, 20px);
}

.chart-card {
  background: white;
  border-radius: var(--radius-lg, 20px);
  padding: var(--spacing-xl, 30px);
  box-shadow:
    0 8px 30px rgba(0, 0, 0, 0.1),
    0 2px 10px rgba(0, 0, 0, 0.05);
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  border: 2px solid rgba(255, 255, 255, 0.8);
}

.chart-card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow:
    0 20px 50px rgba(102, 126, 234, 0.25),
    0 8px 20px rgba(0, 0, 0, 0.15);
  border-color: rgba(102, 126, 234, 0.3);
}

.chart-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.chart-header h5 {
  font-size: 1.2rem;
  font-weight: 700;
  color: #333;
  margin: 0;
}

.chart-summary {
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  padding: var(--spacing-sm, 12px) var(--spacing-md, 18px);
  border-radius: var(--radius-sm, 12px);
  font-size: 1rem;
  color: #555;
  margin-bottom: var(--spacing-sm, 15px);
  line-height: 1.5;
  border-left: 4px solid #667eea;
  text-align: justify;
  text-justify: inter-ideograph;
  overflow-wrap: break-word;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.highlight-text {
  color: #667eea;
  font-weight: 700;
  font-size: 1.05rem;
}

.chart-legend {
  display: flex;
  gap: 20px;
  margin-bottom: 15px;
  padding-left: 8px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
  color: #666;
  font-weight: 500;
}

.legend-color {
  width: 14px;
  height: 14px;
  border-radius: 3px;
}

.chart-container {
  width: 100%;
  height: 340px;
}

.gender-chart-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-md, 20px);
  padding: var(--spacing-md, 20px);
}

.gender-chart-image {
  max-width: 100%;
  height: auto;
  max-height: 320px;
  object-fit: contain;
}

.gender-stats {
  display: flex;
  justify-content: space-around;
  width: 100%;
  max-width: 600px;
  gap: var(--spacing-lg, 30px);
}

.gender-stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  flex: 1;
}

.gender-label {
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: var(--spacing-sm, 12px);
}

.gender-stat-item .stat-text {
  font-size: 0.95rem;
  color: #666;
  margin: var(--spacing-xs, 6px) 0;
  line-height: 1.5;
}

.gender-stat-item .stat-text strong {
  color: #333;
  font-weight: 700;
}

.map-chart {
  height: 450px;
  background: white;
  border-radius: var(--radius-lg, 20px);
  padding: var(--spacing-lg, 25px);
  box-shadow:
    0 8px 30px rgba(0, 0, 0, 0.1),
    0 2px 10px rgba(0, 0, 0, 0.05);
  margin: var(--spacing-xl, 40px) auto;
  max-width: 1400px;
  transition: all 0.3s ease;
}

.map-chart:hover {
  box-shadow:
    0 12px 40px rgba(102, 126, 234, 0.15),
    0 4px 15px rgba(0, 0, 0, 0.1);
}

.wordcloud-chart {
  height: 550px;
  background: white;
  border-radius: var(--radius-lg, 20px);
  padding: var(--spacing-lg, 25px);
  box-shadow:
    0 8px 30px rgba(0, 0, 0, 0.1),
    0 2px 10px rgba(0, 0, 0, 0.05);
  margin: var(--spacing-xl, 40px) auto;
  max-width: 1400px;
  position: relative;
  transition: all 0.3s ease;
}

.psychology-negative .wordcloud-chart {
  margin: var(--spacing-lg, 20px) 0 0 0;
  height: 500px;
}

.wordcloud-chart:hover {
  box-shadow:
    0 12px 40px rgba(102, 126, 234, 0.15),
    0 4px 15px rgba(0, 0, 0, 0.1);
}

.data-note {
  text-align: justify;
  text-justify: inter-ideograph;
  color: #555;
  font-size: 1.05rem;
  line-height: 1.5;
  margin: var(--spacing-md, 20px) auto var(--spacing-lg, 25px);
  max-width: 1400px;
  padding: var(--spacing-sm, 15px) var(--spacing-md, 20px);
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  border-radius: var(--radius-md, 16px);
  border-left: 4px solid #667eea;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
  backdrop-filter: blur(10px);
  overflow-wrap: break-word;
}

/* ==================== è§‚ä¼—å¿ƒç†åˆ†æ ==================== */
.audience-psychology {
  margin: var(--spacing-xl, 40px) auto;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg, 24px);
  max-width: 1400px;
}

.psychology-positive {
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  padding: var(--spacing-lg, 20px) var(--spacing-xl, 28px);
  border-radius: var(--radius-lg, 20px);
  border-left: 5px solid #5B8FF9;
  box-shadow: 0 4px 15px rgba(91, 143, 249, 0.1);
  position: relative;
  backdrop-filter: blur(10px);
}

.psychology-positive::before {
  content: 'ğŸ’™';
  position: absolute;
  top: 20px;
  right: 25px;
  font-size: 2rem;
  opacity: 0.3;
}

.psychology-positive p {
  color: #555;
  font-size: 1.1rem;
  line-height: 1.5;
  margin: var(--spacing-sm, 10px) 0;
  overflow-wrap: break-word;
  text-align: justify;
  text-justify: inter-ideograph;
}

.psychology-positive strong {
  color: #5B8FF9;
  font-weight: 700;
}

.psychology-negative {
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  padding: var(--spacing-lg, 20px) var(--spacing-xl, 28px);
  border-radius: var(--radius-lg, 20px);
  border-left: 5px solid #ff6b6b;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.1);
  position: relative;
  backdrop-filter: blur(10px);
}

.psychology-negative::before {
  content: 'âš ï¸';
  position: absolute;
  top: 20px;
  right: 25px;
  font-size: 2rem;
  opacity: 0.4;
}

.psychology-negative p {
  color: #555;
  font-size: 1.1rem;
  line-height: 1.5;
  margin: 0 0 var(--spacing-md, 15px) 0;
  overflow-wrap: break-word;
  text-align: justify;
  text-justify: inter-ideograph;
}

.psychology-negative .section-subtitle {
  margin-top: 0;
  margin-bottom: var(--spacing-md, 20px);
}

.psychology-negative strong {
  color: #ff6b6b;
  font-weight: 700;
}

/* ==================== æµé‡ç‹‚æ½®æ¡ˆä¾‹ ==================== */
.traffic-craze {
  margin: var(--spacing-lg, 25px) auto;
  padding: var(--spacing-lg, 20px) var(--spacing-xl, 28px);
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  border-radius: var(--radius-lg, 20px);
  border: 2px dashed rgba(102, 126, 234, 0.3);
  max-width: 1400px;
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
}

.craze-intro {
  font-size: 1.15rem;
  line-height: 1.5;
  color: #555;
  text-align: justify;
  text-justify: inter-ideograph;
  margin: 0 0 var(--spacing-lg, 25px) 0;
  font-weight: 500;
  overflow-wrap: break-word;
}

.craze-case {
  max-width: 550px;
  margin: 0 auto;
  background: white;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.craze-case:hover {
  transform: translateY(-8px);
  box-shadow: 0 15px 45px rgba(102, 126, 234, 0.25);
}

.case-image-wrapper {
  width: 100%;
  overflow: hidden;
  background: #f8f9fa;
  position: relative;
}

.case-image {
  width: 100%;
  height: auto;
  display: block;
  transition: transform 0.5s ease;
}

.craze-case:hover .case-image {
  transform: scale(1.08);
}

.case-caption {
  padding: var(--spacing-md, 18px) var(--spacing-lg, 25px);
  font-size: 1.1rem;
  line-height: 1.5;
  color: #2c3e50;
  font-weight: 600;
  text-align: justify;
  text-justify: inter-ideograph;
  margin: 0;
  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
  border-top: 3px solid #667eea;
  overflow-wrap: break-word;
}

/* ==================== è´£ä»»æç¤ºæ¡† ==================== */
.responsibility-box {
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  padding: var(--spacing-lg, 20px) var(--spacing-xl, 28px);
  border-radius: var(--radius-lg, 20px);
  margin: var(--spacing-lg, 25px) auto var(--spacing-md, 20px);
  max-width: 1400px;
  border-left: 5px solid #ff9800;
  box-shadow: 0 4px 15px rgba(255, 152, 0, 0.1);
  backdrop-filter: blur(10px);
}

.responsibility-box p {
  color: #555;
  font-size: 1.1rem;
  line-height: 1.5;
  margin: var(--spacing-sm, 10px) 0;
  text-align: justify;
  /* text-align-last: left; */
  text-justify: auto;
  overflow-wrap: break-word;
  word-break: normal;
}

.responsibility-box strong {
  color: #ff9800;
  font-weight: 700;
}

.data-source {
  text-align: justify;
  text-justify: inter-ideograph;
  color: #666;
  font-size: 0.95rem;
  margin: var(--spacing-lg, 25px) auto var(--spacing-md, 20px);
  max-width: 1400px;
  padding: var(--spacing-md, 18px) var(--spacing-lg, 25px);
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
  border-radius: var(--radius-md, 16px);
  border-top: 2px dashed rgba(102, 126, 234, 0.2);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
  backdrop-filter: blur(10px);
  overflow-wrap: break-word;
  line-height: 1.5;
}

/* ==================== å“åº”å¼è®¾è®¡ ==================== */
@media (max-width: 1024px) {
  h3 {
    font-size: var(--font-size-h2, 2rem);
    padding-bottom: var(--spacing-md, 20px);
  }

  .intro-text {
    font-size: 1.1rem;
    padding: var(--spacing-md, 20px) var(--spacing-lg, 25px);
  }

  .section-subtitle {
    font-size: var(--font-size-h3, 1.6rem);
  }

  .audience-charts {
    grid-template-columns: 1fr;
    gap: var(--spacing-md, 20px);
  }

  .chart-card {
    padding: var(--spacing-lg, 25px);
  }

  .chart-container {
    height: 320px;
  }

  .map-chart,
  .wordcloud-chart {
    padding: var(--spacing-md, 20px);
  }
}

@media (max-width: 768px) {
  h3 {
    font-size: var(--font-size-h2, 1.8rem);
    padding-bottom: var(--spacing-md, 18px);
    margin-bottom: var(--spacing-lg, 30px);
  }

  h3::after {
    width: 60px;
    height: 3px;
  }

  .intro-text {
    font-size: 1rem;
    padding: var(--spacing-md, 18px) var(--spacing-sm, 15px);
    margin-bottom: var(--spacing-lg, 30px);
  }

  .section-subtitle {
    font-size: var(--font-size-h3, 1.4rem);
    padding-bottom: var(--spacing-sm, 15px);
  }

  .section-subtitle::after {
    width: 60px;
    height: 3px;
  }

  .audience-summary {
    padding: var(--spacing-md, 20px) var(--spacing-sm, 15px);
    margin: var(--spacing-md, 20px) auto var(--spacing-lg, 30px);
  }

  .audience-summary p {
    font-size: 1rem;
  }

  .audience-summary li {
    font-size: 0.95rem;
    line-height: 1.5;
  }

  .chart-card {
    padding: var(--spacing-md, 20px);
  }

  .chart-container {
    height: 280px;
  }

  .gender-chart-container {
    padding: var(--spacing-sm, 15px);
    gap: var(--spacing-sm, 15px);
  }

  .gender-chart-image {
    max-height: 280px;
  }

  .gender-stats {
    gap: var(--spacing-md, 20px);
  }

  .gender-label {
    font-size: 1rem;
  }

  .gender-stat-item .stat-text {
    font-size: 0.9rem;
  }

  .map-chart {
    height: 350px;
    padding: var(--spacing-sm, 15px);
  }

  .wordcloud-chart {
    height: 400px;
    padding: var(--spacing-sm, 15px);
  }

  .data-note {
    font-size: 1rem;
    padding: var(--spacing-sm, 15px) var(--spacing-md, 18px);
    margin: var(--spacing-md, 20px) auto var(--spacing-lg, 30px);
  }

  .psychology-positive,
  .psychology-negative {
    padding: var(--spacing-lg, 25px) var(--spacing-md, 20px);
  }

  .psychology-positive::before,
  .psychology-negative::before {
    font-size: 1.5rem;
    top: var(--spacing-sm, 15px);
    right: var(--spacing-md, 20px);
  }

  .psychology-positive p,
  .psychology-negative p {
    font-size: 1rem;
    line-height: 1.5;
  }

  .psychology-negative .wordcloud-chart {
    height: 380px;
    margin-top: var(--spacing-md, 15px);
  }

  .traffic-craze {
    padding: var(--spacing-lg, 25px) var(--spacing-md, 20px);
    margin: var(--spacing-lg, 30px) auto;
  }

  .craze-intro {
    font-size: 1rem;
    margin-bottom: var(--spacing-lg, 25px);
  }

  .case-caption {
    padding: var(--spacing-md, 20px) var(--spacing-sm, 15px);
    font-size: 1rem;
  }

  .responsibility-box {
    padding: var(--spacing-md, 18px) var(--spacing-md, 18px);
    margin: var(--spacing-md, 20px) auto var(--spacing-sm, 15px);
  }

  .responsibility-box p {
    font-size: 1rem;
    line-height: 1.5;
    margin: var(--spacing-xs, 8px) 0;
  }

  .data-source {
    font-size: 0.85rem;
    padding: var(--spacing-md, 20px) var(--spacing-sm, 15px);
    margin: var(--spacing-lg, 30px) auto var(--spacing-md, 20px);
  }
}

@media (max-width: 480px) {
  h3 {
    font-size: var(--font-size-h2, 1.6rem);
  }

  .intro-text {
    font-size: 0.95rem;
    padding: var(--spacing-sm, 15px);
  }

  .section-subtitle {
    font-size: var(--font-size-h3, 1.3rem);
  }

  .audience-charts {
    padding: 0 var(--spacing-xs, 10px);
  }

  .chart-card {
    padding: var(--spacing-sm, 15px);
  }

  .chart-container {
    height: 250px;
  }

  .gender-chart-container {
    padding: var(--spacing-xs, 12px);
    gap: var(--spacing-xs, 12px);
  }

  .gender-chart-image {
    max-height: 250px;
  }

  .gender-stats {
    flex-direction: column;
    gap: var(--spacing-sm, 15px);
  }

  .gender-label {
    font-size: 0.95rem;
  }

  .gender-stat-item .stat-text {
    font-size: 0.85rem;
  }

  .map-chart {
    height: 300px;
    padding: var(--spacing-xs, 10px);
  }

  .wordcloud-chart {
    height: 350px;
    padding: var(--spacing-xs, 10px);
  }

  .psychology-negative .wordcloud-chart {
    height: 320px;
    margin-top: var(--spacing-sm, 12px);
  }

  .psychology-positive p,
  .psychology-negative p {
    font-size: 0.95rem;
  }

  .data-source {
    font-size: 0.8rem;
    padding: var(--spacing-sm, 15px) var(--spacing-xs, 10px);
  }
}
</style>